<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>STL Viewer</title>
  <style>
    body { margin: 0; background: #000; overflow: hidden; }
    canvas { display: block; }
    #fileInput { position: absolute; top: 1rem; left: 1rem; z-index: 1; }
  </style>
</head>
<body>
  <input type="file" id="fileInput" accept=".stl" />
  <script type="module">
import * as THREE from '../../node_modules/three/build/three.module.js'
import { OrbitControls } from '../../node_modules/three/examples/jsm/controls/OrbitControls.js'
import { STLLoader } from '../../node_modules/three/examples/jsm/loaders/STLLoader.js'

const scene = new THREE.Scene()
scene.background = new THREE.Color('#000')

const camera = new THREE.PerspectiveCamera(45, innerWidth / innerHeight, 0.1, 1000)
camera.position.set(0, 0, 100)

const renderer = new THREE.WebGLRenderer({ antialias: true })
renderer.setSize(innerWidth, innerHeight)
document.body.appendChild(renderer.domElement)

const controls = new OrbitControls(camera, renderer.domElement)
controls.enableDamping = true

scene.add(new THREE.AmbientLight(0x888888))
const dirLight = new THREE.DirectionalLight(0xffffff, 0.8)
dirLight.position.set(1, 1, 1)
scene.add(dirLight)

const loader = new STLLoader()

fileInput.addEventListener('change', e => {
  const file = e.target.files[0]
  if (!file) return

  const reader = new FileReader()
  reader.onload = () => {
    const geometry = loader.parse(reader.result)
    const material = new THREE.MeshStandardMaterial({ color: 0x00ffff })
    const mesh = new THREE.Mesh(geometry, material)
    mesh.rotation.x = -Math.PI / 2
    scene.add(mesh)
  }
  reader.readAsArrayBuffer(file)
})

function animate() {
  requestAnimationFrame(animate)
  controls.update()
  renderer.render(scene, camera)
}
animate()

window.addEventListener('resize', () => {
  camera.aspect = innerWidth / innerHeight
  camera.updateProjectionMatrix()
  renderer.setSize(innerWidth, innerHeight)
})

  </script>
</body>
</html>
